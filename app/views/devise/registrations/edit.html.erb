<!-- app/views/devise/registrations/edit.html.erb -->
<div class="container-fluid vh-100">
  <div class="row h-100 align-items-center justify-content-center">
    <div class="col-md-8">
      <div class="card shadow-sm mx-auto">
        <div class="card-body p-0">
          <div class="row g-0">
            <!-- Left side with title -->
            <div class="col-md-4 bg-primary text-white p-4 d-flex align-items-center">
              <div class="w-100">
                <h1 class="display-6 mb-3"><%= t("edit_user.title_edit") %></h1>
                <p class="lead mb-0"><%= t("edit_user.description_edit") %></p>
              </div>
            </div>

            <!-- Right side with form -->
            <div class="col-md-8 p-4">
              <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %>
                
                <!-- Email Field -->
                <div class="mb-3">
                  <%= f.label :email, class: 'form-label' %><br />
                  <%= f.email_field :email, class: 'form-control', autofocus: true, autocomplete: "email" %>
                </div>

                <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
                  <div class="alert alert-info mb-3">
                    Aguardando confirmação para: <%= resource.unconfirmed_email %>
                  </div>
                <% end %>

                <!-- New Password Field -->
                <div class="mb-3">
                  <%= f.label :password, t("edit_user.password_label"), class: 'form-label' %>
                  <i><%=t("edit_user.left_blank")%></i><br />
                  <%= f.password_field :password, class: 'form-control', autocomplete: "new-password" %>
                  <% if @minimum_password_length %>
                    <div class="form-text text-muted">
                      <em><%= @minimum_password_length %> <%=t("edit_user.minimum_length")%></em>
                    </div>
                  <% end %>
                </div>

                <!-- Password Confirmation Field -->
                <div class="mb-3">
                  <%= f.label :password_confirmation, t("edit_user.password_confirmation_label"), class: 'form-label' %><br />
                  <%= f.password_field :password_confirmation, class: 'form-control', autocomplete: "new-password" %>
                </div>

                <!-- Error message for password confirmation mismatch -->
                <% if resource.errors[:password_confirmation].any? %>
                  <div class="alert alert-danger alert-dismissible fade show">
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    <ul>
                      <% resource.errors[:password_confirmation].each do |msg| %>
                        <li><%= msg %></li>
                      <% end %>
                    </ul>
                  </div>
                <% end %>

                <!-- Current Password Field -->
                <div class="mb-4">
                  <%= f.label :current_password, t("edit_user.current_password_label"), class: 'form-label' %>
                  <i><%= t("edit_user.current_password_hint") %></i><br />
                  <%= f.password_field :current_password, class: 'form-control', autocomplete: "current-password", required: true %>
                  <div class="form-text text-muted">
                    <%= t("edit_user.current_password_hint") %>
                  </div>
                </div>

                <!-- Error message for current password -->
                <% if resource.errors[:current_password].any? %>
                  <div class="alert alert-danger alert-dismissible fade show">
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    <ul>
                      <% resource.errors[:current_password].each do |msg| %>
                        <li><%= msg %></li>
                      <% end %>
                    </ul>
                  </div>
                <% end %>

                <!-- Update Button -->
                <div class="d-grid gap-2">
                  <%= f.submit t("edit_user.update_button"), class: 'btn btn-primary' %>
                </div>
              <% end %>

              <!-- Delete Account Section -->
              <div class="mt-5 pt-3 border-top text-center">
                <h3 class="h5 mb-3"><%= t("edit_user.cancel_account") %></h3>
                <div class="d-flex align-items-center justify-content-center">
                  <%= button_to t("edit_user.cancel_account"), registration_path(resource_name), data: { confirm: t("edit_user.cancel_account_confirm") }, method: :delete, class: 'btn btn-danger' %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
